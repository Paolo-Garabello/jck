import{g as l}from"../chunks/entry.DpfWPHTa.js";import{s as r,a as c,u as i,g,b as u}from"../chunks/scheduler.DbuCXXLn.js";import{S as m,i as f,t as _,b as d}from"../chunks/index.TDUkrpct.js";const S="ws://5.75.132.76:8888",p=!1,b=()=>{let o=new WebSocket(S),s=localStorage.getItem("auth_token");return o.onopen=()=>{console.log("WebSocket connection established"),o.send(JSON.stringify({request:"auth",data:s}))},o.onclose=()=>{console.log("WebSocket connection closed.")},o.onerror=a=>{console.error("WebSocket error:",a)},o.onmessage=a=>{sessionStorage.setItem("websocket.message",a.data);let t=sessionStorage.getItem("websocket.message");if(!t)return;const e=JSON.parse(t);console.log("ws data: "+JSON.stringify(e)),e.statusCode===205&&(localStorage.setItem("logged",String(e.ok)),localStorage.setItem("auth_token",e.data.token),sessionStorage.setItem("public_username",e.data.publicUsername),sessionStorage.removeItem("websocket.message")),e.statusCode===403&&(localStorage.setItem("logged","false"),localStorage.setItem("dmMessages","[]"),localStorage.setItem("user","{}"),l("/login"))},{websocket:o}},y=Object.freeze(Object.defineProperty({__proto__:null,load:b,ssr:p},Symbol.toStringTag,{value:"Module"}));function k(o){let s;const a=o[1].default,t=c(a,o,o[0],null);return{c(){t&&t.c()},l(e){t&&t.l(e)},m(e,n){t&&t.m(e,n),s=!0},p(e,[n]){t&&t.p&&(!s||n&1)&&i(t,a,e,e[0],s?u(a,e[0],n,null):g(e[0]),null)},i(e){s||(_(t,e),s=!0)},o(e){d(t,e),s=!1},d(e){t&&t.d(e)}}}function I(o,s,a){let{$$slots:t={},$$scope:e}=s;return o.$$set=n=>{"$$scope"in n&&a(0,e=n.$$scope)},[e,t]}class O extends m{constructor(s){super(),f(this,s,I,k,r,{})}}export{O as component,y as universal};
